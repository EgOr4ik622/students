class DataImporter:
    def __init__(self, db_manager):
        self.db_manager = db_manager

    def import_from_json_students(self, file_path_students, table_name):
        with open(file_path_students, 'r', encoding='utf-8') as file:
            data = json.load(file)

        for item in data:
            query = f"""
                INSERT INTO {table_name} (birthday, id, name, room, sex) 
                VALUES (%s, %s, %s, %s, %s)
            """
            values = (item['birthday'], item['id'], item['name'], item['room'], item['sex'])
            self.db_manager.execute_query(query, values, fetch=False)
            print(f"Данные для {item['name']} добавлены")

    def import_from_json_rooms(self, file_path_rooms, name_room_tb):
        with open(file_path_rooms, 'r', encoding='utf-8') as file:
            data = json.load(file)

        for item in data:
            query = f"""
                INSERT INTO {name_room_tb} (id, name) 
                VALUES (%s, %s)
            """
            values = (item['id'], item['name'])
            self.db_manager.execute_query(query, values, fetch=False)
            print(f"Данные для {item['name']} добавлены")
